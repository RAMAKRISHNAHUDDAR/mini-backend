rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if false;
    }
  }
}

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // =============================
    // DIET PLANS
    // =============================
    match /dietPlans/{patientId} {

      // üßë‚Äçü¶± PATIENT
      // Can read only their own diet
      allow read: if request.auth != null
        && request.auth.token.role == "patient"
        && request.auth.uid == patientId;

      // üë®‚Äç‚öïÔ∏è DOCTOR
      // Can read & write diet for assigned patient
      allow read, write: if request.auth != null
        && request.auth.token.role == "doctor"
        && request.resource.data.doctorId == request.auth.uid;

      // ‚ùå NO DELETE FROM CLIENT
      allow delete: if false;
    }

    // =============================
    // DEFAULT DENY
    // =============================
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
